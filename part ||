Write SQL queries to answer the following questions:

1.	What is the total revenue generated by the store?


use `jvr_eStore`;

SELECT SUM(products.price * order_items.quantity) AS total_revenue
FROM order_items
JOIN products ON order_items.product_id = products.product_id;


2.	What is the most popular product in terms of quantity sold?

use `jvr_eStore`;

SELECT p.name AS product_name, SUM(oi.quantity) AS total_quantity_sold
FROM order_items oi
JOIN products p ON oi.product_id = p.product_id
GROUP BY oi.product_id
ORDER BY total_quantity_sold DESC
LIMIT 1;

3.	What is the email address of the customer who has made the most purchases?

SELECT c.email
FROM customers c
INNER JOIN orders o ON c.customer_id = o.customer_id
INNER JOIN order_items oi ON o.order_id = oi.order_id
GROUP BY c.customer_id
ORDER BY SUM(oi.quantity) DESC
LIMIT 1;


4.What is the total revenue generated by each customer?

use `jvr_eStore`;

SELECT c.customer_id, c.name, c.email, SUM(oi.quantity * p.price) AS total_revenue
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
JOIN order_items oi ON o.order_id = oi.order_id
JOIN products p ON oi.product_id = p.product_id
GROUP BY c.customer_id
ORDER BY total_revenue DESC;

